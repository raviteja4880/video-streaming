import{C,r as c,u as L,k as q,j as e,c as x,A as i}from"./index-DyDKpjxL.js";function B(){const{login:h}=C(),[p,d]=c.useState("login"),[n,g]=c.useState(""),[y,N]=c.useState(""),[f,w]=c.useState(""),[b,v]=c.useState(""),[o,l]=c.useState(!1),j=L(),k=q(),E=async t=>{var a,r,s,m;t.preventDefault(),l(!0);try{const u=await x.post("/users/login",{email:n,password:y});h(u.data),j(((r=(a=k.state)==null?void 0:a.from)==null?void 0:r.pathname)||"/",{replace:!0})}catch(u){i.error(((m=(s=u.response)==null?void 0:s.data)==null?void 0:m.message)||u.message)}finally{l(!1)}},P=async t=>{var a,r;if(t.preventDefault(),!n)return i.warn("Enter your email first");l(!0);try{const{data:s}=await x.post("/users/forgot-password",{email:n});i.success(s.message||"OTP sent to your email"),d("verify")}catch(s){i.error(((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Email not found")}finally{l(!1)}},S=async t=>{var a,r;t.preventDefault(),l(!0);try{const{data:s}=await x.post("/users/reset-password",{email:n,code:f,newPassword:b});i.success("Password reset successfully! Logging you in...");const m=await x.post("/users/login",{email:n,password:b});h(m.data),j("/",{replace:!0})}catch(s){i.error(((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Invalid OTP or expired")}finally{l(!1)}};return e.jsx("div",{className:"auth-page d-flex align-items-center justify-content-center",children:e.jsxs("div",{className:"auth-card p-4 rounded shadow",children:[p==="login"&&e.jsxs("form",{onSubmit:E,children:[e.jsx("h3",{className:"mb-4 text-center text-light",children:"Welcome Back"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Email"}),e.jsx("input",{type:"email",className:"form-control bg-dark text-light border-secondary",value:n,onChange:t=>g(t.target.value),required:!0,placeholder:"Enter your email"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label text-secondary",children:"Password"}),e.jsx("input",{type:"password",className:"form-control bg-dark text-light border-secondary",value:y,onChange:t=>N(t.target.value),required:!0,placeholder:"Enter your password"})]}),e.jsx("button",{className:"btn btn-primary w-100",disabled:o,children:o?"Loading...":"Login"}),e.jsx("p",{className:"text-center mt-3 mb-0",children:e.jsx("button",{type:"button",className:"btn btn-link text-info p-0",onClick:()=>d("forgot"),children:"Forgot Password?"})})]}),p==="forgot"&&e.jsxs("form",{onSubmit:P,children:[e.jsx("h3",{className:"mb-4 text-center text-light",children:"Forgot Password"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Email"}),e.jsx("input",{type:"email",className:"form-control bg-dark text-light border-secondary",value:n,onChange:t=>g(t.target.value),required:!0,placeholder:"Enter your registered email"})]}),e.jsx("button",{className:"btn btn-primary w-100",disabled:o,children:o?"Sending...":"Send OTP"}),e.jsx("p",{className:"text-center mt-3 mb-0",children:e.jsx("button",{type:"button",className:"btn btn-link text-info p-0",onClick:()=>d("login"),children:"Back to Login"})})]}),p==="verify"&&e.jsxs("form",{onSubmit:S,children:[e.jsx("h3",{className:"mb-4 text-center text-light",children:"Verify & Reset"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"OTP Code"}),e.jsx("input",{type:"text",className:"form-control bg-dark text-light border-secondary",value:f,onChange:t=>w(t.target.value),required:!0,placeholder:"Enter 6-digit code"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control bg-dark text-light border-secondary",value:b,onChange:t=>v(t.target.value),required:!0,placeholder:"Enter new password"})]}),e.jsx("button",{className:"btn btn-primary w-100",disabled:o,children:o?"Verifying...":"Confirm & Login"}),e.jsx("p",{className:"text-center mt-3 mb-0",children:e.jsx("button",{type:"button",className:"btn btn-link text-info p-0",onClick:()=>d("login"),children:"Back to Login"})})]})]})})}export{B as default};
