import{r as o,u as S,j as e,b as m,A as r}from"./index-B8jYU2_8.js";function P(){const[b,f]=o.useState("register"),[u,p]=o.useState(""),[c,h]=o.useState(""),[x,y]=o.useState(""),[g,j]=o.useState(""),[d,l]=o.useState(!1),N=S(),v=async s=>{var t,a,n;s.preventDefault(),l(!0);try{const{data:i}=await m.post("/users/register",{name:u,email:c,password:x});(t=i==null?void 0:i.user)!=null&&t.email?(h(i.user.email),f("verify"),r.success("Registration successful! Check your email for OTP.")):r.warn("Something went wrong, please try again.")}catch(i){r.error(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.message)||"Registration failed")}finally{l(!1)}},w=async s=>{var t,a;s.preventDefault(),l(!0);try{const{data:n}=await m.post("/users/verify-otp",{email:c,code:g});r.success(n.message||"Email verified successfully!"),setTimeout(()=>N("/login",{replace:!0}),1500)}catch(n){r.error(((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.message)||"Invalid or expired OTP")}finally{l(!1)}},E=async()=>{var s,t;l(!0);try{const{data:a}=await m.post("/users/resend-otp",{email:c});r.info(a.message||"OTP resent to your email.")}catch(a){r.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to resend OTP")}finally{l(!1)}};return e.jsx("div",{className:"auth-page d-flex align-items-center justify-content-center",children:e.jsx("div",{className:"auth-card p-4 rounded shadow",children:b==="register"?e.jsxs("form",{onSubmit:v,children:[e.jsx("h3",{className:"mb-4 text-center text-light",children:"Create Account"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Full Name"}),e.jsx("input",{className:"form-control bg-dark text-light border-secondary",value:u,onChange:s=>p(s.target.value),required:!0,placeholder:"Enter your name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Email"}),e.jsx("input",{type:"email",className:"form-control bg-dark text-light border-secondary",value:c,onChange:s=>h(s.target.value),required:!0,placeholder:"Enter your email"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label text-secondary",children:"Password"}),e.jsx("input",{type:"password",className:"form-control bg-dark text-light border-secondary",value:x,onChange:s=>y(s.target.value),required:!0,placeholder:"Choose a strong password"})]}),e.jsx("button",{className:"btn btn-primary w-100",disabled:d,children:d?"Registering...":"Register"})]}):e.jsxs("form",{onSubmit:w,children:[e.jsx("h3",{className:"mb-4 text-center text-light",children:"Verify Email"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Email"}),e.jsx("input",{type:"email",className:"form-control bg-dark text-light border-secondary",value:c,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label text-secondary",children:"Enter OTP"}),e.jsx("input",{type:"text",className:"form-control bg-dark text-light border-secondary",value:g,onChange:s=>j(s.target.value),required:!0,placeholder:"Enter the 6-digit code"})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-primary flex-fill",disabled:d,children:d?"Verifying...":"Verify OTP"}),e.jsx("button",{type:"button",className:"btn btn-outline-light flex-fill",onClick:E,disabled:d,children:"Resend OTP"})]})]})})})}export{P as default};
